---
title: "hw2"
author: "Simon Lee"
date: "2022-10-14"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include= FALSE}
{
  library(ggplot2)
  library(tidyverse)
  library(tidymodels)
  library(corrplot)
  library(ggthemes)
  library(ISLR)
  tidymodels_prefer()
  getwd()
  abaloneD <- read.csv(file= "data/abalone.csv")
}
```

```{r}
abaloneD <- abaloneD %>% 
  mutate(age = rings+1.5) %>% 
  select(age, everything())

abaloneD %>% 
  ggplot(aes(x = age)) +
  geom_histogram(bins = 30)
```

From the histogram the age of the abalones has a slight right skew and the mass
of its distribution is centered around 5 and 15 years

```{r}
set.seed(115)
abalone_split <- initial_split(abaloneD, prop = 0.8, strata = age)
abalone_train <- training(abalone_split)
abalone_test <- testing(abalone_split)
```

```{r}
?step_interact()
abalone_recipe <- recipe(age ~ ., data = abalone_train) %>% 
  step_rm(rings) %>% 
  step_dummy(all_nominal_predictors()) %>% 
  step_interact(~shucked_weight:type_M + diamter:longest_shell + shell_weight:shucked_weight)
abalone_recipe
```

There is no point trying to precit age using the rings variable since to count the rings
we would have to cut the shell open and count using a microscope. The model is made
to see if we can predict the age without the rings variable. 

```{r}
lm_model <- linear_reg() %>% 
  set_engine("lm")
```

```{r}
lm_wflow <- workflow() %>% 
  add_model(lm_model) %>% 
  add_recipe(abalone_recipe)
```

```{r}
lm_fit <- fit(lm_wflow, abalone_train)
```
